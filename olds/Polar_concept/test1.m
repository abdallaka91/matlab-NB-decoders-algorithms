clear
p0=[0.1 0.1 0.7 0.1];
p1=[0.4 0.2 0.2 0.2];
p2=[0.4 0.2 0.1 0.3];
p3=[0.2 0.5 0.1 0.2];

p02(1) = p0(1)*p2(1)+p0(2)*p2(2)+p0(3)*p2(3)+p0(4)*p2(4);
p02(2) = p0(1)*p2(2)+p0(2)*p2(1)+p0(4)*p2(3)+p0(3)*p2(4);
p02(3) = p0(1)*p2(3)+p0(3)*p2(1)+p0(2)*p2(4)+p0(4)*p2(2);
p02(4) = p0(1)*p2(4)+p0(4)*p2(1)+p0(2)*p2(3)+p0(3)*p2(2);

p00=[1 0 0 0];

p0200(1) = p02(1)*p00(1)+p02(2)*p00(2)+p02(3)*p00(3)+p02(4)*p00(4);
p0200(2) = p02(1)*p00(2)+p02(2)*p00(1)+p02(4)*p00(3)+p02(3)*p00(4);
p0200(3) = p02(1)*p00(3)+p02(3)*p00(1)+p02(2)*p00(4)+p02(4)*p00(2);
p0200(4) = p02(1)*p00(4)+p02(4)*p00(1)+p02(2)*p00(3)+p02(3)*p00(2);

p13(1) = p1(1)*p3(1)+p1(2)*p3(2)+p1(3)*p3(3)+p1(4)*p3(4);
p13(2) = p1(1)*p3(2)+p1(2)*p3(1)+p1(4)*p3(3)+p1(3)*p3(4);
p13(3) = p1(1)*p3(3)+p1(3)*p3(1)+p1(2)*p3(4)+p1(4)*p3(2);
p13(4) = p1(1)*p3(4)+p1(4)*p3(1)+p1(2)*p3(3)+p1(3)*p3(2);

s10 = (p0200(1)*p13(1)+p0200(2)*p13(2)+p0200(3)*p13(3)+p0200(4)*p13(4));
p10(1) = p0200(1)*p13(1)/s10;
p10(2) = p0200(2)*p13(2)/s10;
p10(3) = p0200(3)*p13(3)/s10;
p10(4) = p0200(4)*p13(4)/s10;

p13 = p10;

p3(1) = p1(1)*p13(1)+p1(2)*p13(2)+p1(3)*p13(3)+p1(4)*p13(4);
p3(2) = p1(1)*p13(2)+p1(2)*p13(1)+p1(4)*p13(3)+p1(3)*p13(4);
p3(3) = p1(1)*p13(3)+p1(3)*p13(1)+p1(2)*p13(4)+p1(4)*p13(2);
p3(4) = p1(1)*p13(4)+p1(4)*p13(1)+p1(2)*p13(3)+p1(3)*p13(2);

p30=p3;

p20(1) = p3(1)*p2(1)+p3(2)*p2(2)+p3(3)*p2(3)+p3(4)*p2(4);
p20(2) = p3(1)*p2(2)+p3(2)*p2(1)+p3(4)*p2(3)+p3(3)*p2(4);
p20(3) = p3(1)*p2(3)+p3(3)*p2(1)+p3(2)*p2(4)+p3(4)*p2(2);
p20(4) = p3(1)*p2(4)+p3(4)*p2(1)+p3(2)*p2(3)+p3(3)*p2(2);


